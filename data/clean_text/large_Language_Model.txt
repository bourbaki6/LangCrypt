a large language model llm is a language model trained with selfsupervised machine learning on a vast amount of text designed for natural language processing tasks especially language generation the largest and most capable llms are generative pretrained transformers gpts that provide the core capabilities of modern chatbots llms can be finetuned for specific tasks or guided by prompt engineering these models acquire predictive power regarding syntax semantics and ontologies inherent in human language corpora but they also inherit inaccuracies and biases present in the data they are trained on they consist of billions to trillions of parameters and operate as generalpurpose sequence models generating summarizing translating and reasoning over text llms represent a significant new technology in their ability to generalize across tasks with minimal taskspecific supervision enabling capabilities like conversational agents code generation knowledge retrieval and automated reasoning that previously required bespoke systems llms evolved from earlier statistical and recurrent neural network approaches to language modeling the transformer architecture introduced in  replaced recurrence with selfattention allowing efficient parallelization longer context handling and scalable training on unprecedented data volumes this innovation enabled models like gpt bert and their successors which demonstrated emergent behaviors at scale such as fewshot learning and compositional reasoning reinforcement learning particularly policy gradient algorithms has been adapted to finetune llms for desired behaviors beyond raw nexttoken prediction reinforcement learning from human feedback rlhf applies these methods to optimize a policy the llms output distribution against reward signals derived from human or automated preference judgments this has been critical for aligning model outputs with user expectations improving factuality reducing harmful responses and enhancing task performance benchmark evaluations for llms have evolved from narrow linguistic assessments toward comprehensive multitask evaluations measuring reasoning factual accuracy alignment and safety hill climbing iteratively optimizing models against benchmarks has emerged as a dominant strategy producing rapid incremental performance gains but raising concerns of overfitting to benchmarks rather than achieving genuine generalization or robust capability improvements history before the emergence of transformerbased models in  some language models were considered large relative to the computational and data constraints of their time in the early s ibms statistical models pioneered word alignment techniques for machine translation laying the groundwork for corpusbased language modeling in  a smoothed ngram model such as those employing kneserney smoothing trained on  million words achieved stateoftheart perplexity on benchmark tests during the s with the rise of widespread internet access researchers began compiling massive text datasets from the web web as corpus to train statistical language models moving beyond ngram models researchers started in  to use neural networks to learn language models following the breakthrough of deep neural networks in image classification around  similar architectures were adapted for language tasks this shift was marked by the development of word embeddings eg wordvec by mikolov in  and sequencetosequence seqseq models using lstm in  google transitioned its translation service to neural machine translation nmt replacing statistical phrasebased models with deep recurrent neural networks these early nmt systems used lstmbased encoderdecoder architectures as they preceded the invention of transformers at the  neurips conference google researchers introduced the transformer architecture in their landmark paper attention is all you need this papers goal was to improve upon  seqseq technology and was based mainly on the attention mechanism developed by bahdanau et al in  the following year in  bert was introduced and quickly became ubiquitous though the original transformer has both encoder and decoder blocks bert is an encoderonly model academic and research usage of bert began to decline in  following rapid improvements in the abilities of decoderonly models such as gpt to solve tasks via prompting although decoderonly gpt was introduced in  it was gpt in  that caught widespread attention because openai claimed to have initially deemed it too powerful to release publicly out of fear of malicious use gpt in  went a step further and as of  is available only via api with no offering of downloading the model to execute locally but it was the  consumerfacing chatbot chatgpt that received extensive media coverage and public attention the  gpt was praised for its increased accuracy and as a holy grail for its multimodal capabilities openai did not reveal the highlevel architecture and the number of parameters of gpt the release of chatgpt led to an uptick in llm usage across several research subfields of computer science including robotics software engineering and societal impact work in  openai released the reasoning model openai o which generates long chains of thought before returning a final answer many llms with parameter counts comparable to those of openais gpt series have been developed since  openweight models have been gaining popularity especially at first with bloom and llama though both have restrictions on usage and deployment mistral ais models mistral b and mixtral xb have a more permissive apache license in january  deepseek released deepseek r a billionparameter openweight model that performs comparably to openai o but at a much lower price per token for users since  many llms have been trained to be multimodal having the ability to also process or generate other types of data such as images audio or d meshes these llms are also called large multimodal models lmms or multimodal large language models mllms as of  the largest and most capable models are all based on the transformer architecture some recent implementations are based on other architectures such as recurrent neural network variants and mamba a state space model openweight llms have increasingly shaped the field since  contributing to broader participation in ai development and greater transparency in model evaluation vake et al  demonstrated that communitydriven contributions to openweight models measurably improve their efficiency and performance with user participation growing rapidly on collaborative platforms such as hugging face paris et al  further argued that openness in ai should extend beyond releasing model code or weights to encompass inclusiveness accountability and ethical responsibility in ai research and deployment collectively these studies highlight that openweight llms can accelerate innovation and enhance scientific reproducibility while fostering a more transparent and participatory ai ecosystem dataset preprocessing tokenization as machine learning algorithms process numbers rather than text the text must be converted to numbers in the first step a vocabulary is decided upon then integer indices are arbitrarily but uniquely assigned to each vocabulary entry and finally an embedding is associated to the integer index algorithms include bytepair encoding bpe and wordpiece there are also special tokens serving as control characters such as mask for maskedout token as used in bert and unk unknown for characters not appearing in the vocabulary also some special symbols are used to denote special text formatting for example g denotes a preceding whitespace in roberta and gpt and  denotes continuation of a preceding word in bert for example the bpe tokenizer used by the legacy version of gpt would split tokenizer texts  series of numerical tokens as tokenization also compresses the datasets because llms generally require input to be an array that is not jagged the shorter texts must be padded until they match the length of the longest one the average number of words per token depends on the language bytepair encoding as an example consider a tokenizer based on bytepair encoding in the first step all unique characters including blanks and punctuation marks are treated as an initial set of ngrams ie initial set of unigrams successively the most frequent pair of adjacent characters is merged into a bigram and all instances of the pair are replaced by it all occurrences of adjacent pairs of previously merged ngrams that most frequently occur together are then again merged into even lengthier ngram until a vocabulary of prescribed size is obtained after a tokenizer is trained any text can be tokenized by it as long as it does not contain characters not appearing in the initialset of unigrams problems a token vocabulary based on the frequencies extracted from mainly english corpora uses as few tokens as possible for an average english word however an average word in another language encoded by such an englishoptimized tokenizer is split into a suboptimal amount of tokens gpt tokenizer can use up to  times more tokens per word for some languages for example for the shan language from myanmar even more widespread languages such as portuguese and german have a premium of  compared to english dataset cleaning in the context of training llms datasets are typically cleaned by removing lowquality duplicated or toxic data cleaned datasets can increase training efficiency and lead to improved downstream performance a trained llm can be used to clean datasets for training a further llm with the increasing proportion of llmgenerated content on the web data cleaning in the future may include filtering out such content llmgenerated content can pose a problem if the content is similar to human text making filtering difficult but of lower quality degrading performance of models trained on it synthetic data training of largest language models might need more linguistic data than naturally available or that the naturally occurring data is of insufficient quality in these cases synthetic data might be used microsofts phi series of llms is trained on textbooklike data generated by another llm training an llm is a type of foundation model large x model trained on language llms can be trained in different ways in particular gpt models are first pretrained to predict the next word on a large amount of data before being finetuned cost substantial infrastructure is necessary for training the largest models the tendency towards larger models is visible in the list of large language models for example the training of gpt ie a billionparameters model in  cost  while training of the palm ie a billionparameters model in  cost  million and megatronturing nlg b in  cost around  million the qualifier large in large language model is inherently vague as there is no definitive threshold for the number of parameters required to qualify as large gpt of  has  million parameters finetuning before being finetuned most llms are nexttoken predictors the finetuning shapes the llms behavior via techniques like reinforcement learning from human feedback rlhf or constitutional ai instruction finetuning is a form of supervised learning used to teach llms to follow user instructions in  openai demonstrated instructgpt a version of gpt similarly finetuned to follow instructions reinforcement learning from human feedback rlhf involves training a reward model to predict which text humans prefer then the llm can be finetuned through reinforcement learning to better satisfy this reward model since humans typically prefer truthful helpful and harmless answers rlhf favors such answers architecture llms are generally based on the transformer architecture which leverages an attention mechanism that enables the model to process relationships between all elements in a sequence simultaneously regardless of their distance from each other attention mechanism and context window in order to find out which tokens are relevant to each other within the scope of the context window the attention mechanism calculates soft weights for each token more precisely for its embedding by using multiple attention heads each with its own relevance for calculating its own soft weights for example the small ie m parameter sized gpt model has had twelve attention heads and a context window of only k tokens in its medium version it has m parameters and contains  layers each with  attention heads for the training with gradient descent a batch size of  was utilized googles gemini  introduced in february  can have a context window of up to  million tokens a model may be pretrained either to predict how the segment continues or what is missing in the segment given a segment from its training dataset it can be either autoregressive ie predicting how the segment continues as gpts do for example given a segment i like to eat the model predicts ice cream or sushi masked ie filling in the parts missing from the segment the way bert does it for example given a segment i like to   cream the model predicts that eat and ice are missing models may be trained on auxiliary tasks which test their understanding of the data distribution such as next sentence prediction nsp in which pairs of sentences are presented and the model must predict whether they appear consecutively in the training corpus during training regularization loss is also used to stabilize training however regularization loss is usually not used during testing and evaluation mixture of experts a mixture of experts moe is a machine learning architecture in which multiple specialized neural networks experts work together with a gating mechanism that routes each input to the most appropriate experts mixtures of experts can reduce inference costs as only a fraction of the parameters are used for each input the approach was introduced in  by google researchers parameter size typically llms are trained with single or halfprecision floating point numbers float and float one float has  bits or  bytes and so one billion parameters require  gigabytes the largest models typically have more than  billion parameters which places them outside the range of most consumer electronics quantization posttraining quantization aims to decrease the space requirement by lowering precision of the parameters of a trained model while preserving most of its performance quantization can be further classified as static quantization if the quantization parameters are determined beforehand typically during a calibration phase and dynamic quantization if the quantization is applied during inference the simplest form of quantization simply truncates all the parameters to a given number of bits this is applicable to static as well as dynamic quantization but loses much precision dynamic quantization allows for the use of a different quantization codebook per layer either a lookup table of values or a linear mapping scaling factor and bias at the cost of foregoing the possible speed improvements from using lowerprecision arithmetic quantized models are typically seen as frozen with modification of weights eg finetuning only applied to the original model it is possible to finetune quantized models using lowrank adaptation extensibility beyond basic text generation various techniques have been developed to extend llm capabilities including the use of external tools and data sources improved reasoning on complex problems and enhanced instructionfollowing or autonomy through prompting methods prompt engineering in  openai researchers demonstrated that their new model gpt could understand what format to use given a few rounds of q and a or other type of task in the input data as example thanks in part due to the rlhf technique this technique called fewshot prompting allows llms to be adapted to any task without requiring finetuning also in  it was found that the base gpt model can generate an instruction based on user input the generated instruction along with user input is then used as input to another instance of the model under a instruction  input  output format the other instance is able to complete the output and often produces the correct answer in doing so the ability to selfinstruct makes llms able to bootstrap themselves toward a correct answer dialogue processing chatbot an llm can be turned into a chatbot by specializing it for conversation user input is prefixed with a marker such as q or user and the llm is asked to predict the output after a fixed a or assistant this type of model became commercially available in  with chatgpt a sibling model of instructgpt finetuned to accept and produce dialogformatted text based on gpt it could similarly follow user instructions before the stream of user and assistant lines a chat context usually start with a few lines of overarching instructions from a role called developer or system to convey a higher authority than the users input this is called a system prompt retrievalaugmented generation retrievalaugmented generation rag is an approach that integrates llms with document retrieval systems given a query a document retriever is called to retrieve the most relevant documents this is usually done by encoding the query and the documents into vectors then finding the documents with vectors usually stored in a vector database most similar to the vector of the query the llm then generates an output based on both the query and context included from the retrieved documents tool use tool use is a mechanism that enables llms to interact with external systems applications or data sources it can allow for example to fetch realtime information from an api or to execute code a program separate from the llm watches the output stream of the llm for a special toolcalling syntax when these special tokens appear the program calls the tool accordingly and feeds its output back into the llms input stream early toolusing llms were finetuned on the use of specific tools but finetuning llms for the ability to read api documentation and call api correctly has greatly expanded the range of tools accessible to an llm describing available tools in the system prompt can also make an llm able to use tools a system prompt instructing chatgpt gpt to use multiple types of tools can be found online agency an llm is typically not an autonomous agent by itself as it lacks the ability to interact with dynamic environments recall past behaviors and plan future actions but it can be transformed into an agent by adding supporting elements the role profile and the surrounding environment of an agent can be additional inputs to the llm while memory can be integrated as a tool or provided as additional input instructions and input patterns are used to make the llm plan actions and tool use is used to potentially carry out these actions the react pattern a portmanteau of reason and act constructs an agent out of an llm using the llm as a planner the llm is prompted to think out loud specifically the language model is prompted with a textual description of the environment a goal a list of possible actions and a record of the actions and observations so far it generates one or more thoughts before generating an action which is then executed in the environment in the deps describe explain plan and select method an llm is first connected to the visual world via image descriptions it is then prompted to produce plans for complex tasks and behaviors based on its pretrained knowledge and the environmental feedback it receives the reflexion method constructs an agent that learns over multiple episodes at the end of each episode the llm is given the record of the episode and prompted to think up lessons learned which would help it perform better at a subsequent episode these lessons learned are stored as a form of longterm memory and given to the agent in the subsequent episodes monte carlo tree search can use an llm as rollout heuristic when a programmatic world model is not available an llm can also be prompted with a description of the environment to act as world model for openended exploration an llm can be used to score observations for their interestingness which can be used as a reward signal to guide a normal nonllm reinforcement learning agent alternatively it can propose increasingly difficult tasks for curriculum learning instead of outputting individual actions an llm planner can also construct skills or functions for complex action sequences the skills can be stored and later invoked allowing increasing levels of abstraction in planning multiple agents with memory can interact socially reasoning llms are conventionally trained to generate an output without generating intermediate steps as a result their performance tends to be subpar on complex questions requiring at least in humans intermediate steps of thought early research demonstrated that inserting intermediate scratchpad computations could improve performance on such tasks later methods overcame this deficiency more systematically by breaking tasks into smaller steps for the llm either manually or automatically chaining prompt chaining was introduced in  in this method a user manually breaks a complex problem down into several steps in each step the llm receives as input a prompt telling it what to do and some results from preceding steps the result from one step is then reused in a next step until a final answer is reached the ability of an llm to follow instructions means that even nonexperts can write a successful collection of stepwise prompts given a few rounds of trial and error a  paper demonstrated a separate technique called chainofthought prompting which makes the llm break the question down autonomously an llm is given some examples where the assistant verbally breaks down the thought process before arriving at an answer the llm mimics these examples and also tries to spend some time generating intermediate steps before providing the final answer this additional step elicited by prompting improves the correctness of the llm on relatively complex questions on math word questions a prompted model can exceed even finetuned gpt with a verifier chainofthought can also be elicited by simply adding an instruction like lets think step by step to the prompt in order to encourage the llm to proceed methodically instead of trying to directly guess the answer modelnative reasoning in late  a new approach to llm development emerged with reasoning models these are trained to generate stepbystep analysis before producing final answers enabling better results on complex tasks for instance in mathematics coding and logic openai introduced this concept with their o model in september  followed by o in april  on the international mathematics olympiad qualifying exam problems gpto achieved  accuracy while o reached  in january  the chinese company deepseek released deepseekr a billionparameter openweight reasoning model that achieved comparable performance to openais o while being significantly more costeffective to operate unlike proprietary models from openai deepseekrs openweight nature allowed researchers to study and build upon the algorithm though its training data remained private these reasoning models typically require more computational resources per query compared to traditional llms as they perform more extensive processing to work through problems stepbystep inference optimization inference optimization refers to techniques that improve llm performance by applying additional computational resources during the inference process rather than requiring model retraining these approaches implement various stateoftheart reasoning and decisionmaking strategies to enhance accuracy and capabilities optillm is an openai apicompatible optimizing inference proxy that implements multiple inference optimization techniques simultaneously the system acts as a transparent proxy that can work with any llm provider implementing techniques such as monte carlo tree search mcts mixture of agents moa bestofn sampling and chainofthought reflection optillm demonstrates that strategic application of computational resources at inference time can substantially improve model performance across diverse tasks achieving significant improvements on benchmarks such as the aime  mathematics competition and various coding challenges these inference optimization approaches represent a growing category of tools that enhance existing llms without requiring access to model weights or retraining making advanced reasoning capabilities more accessible across different model providers and use cases forms of input and output multimodality multimodality means having multiple modalities where a modality refers to a type of input or output such as video image audio text proprioception etc for example google palm model was finetuned into a multimodal model and applied to robotic control llama models have also been turned multimodal using the tokenization method to allow image inputs and video inputs gpto can process and generate text audio and images such models are sometimes called large multimodal models lmms a common method to create multimodal models out of an llm is to tokenize the output of a trained encoder concretely one can construct an llm that can understand images as follows take a trained llm and take a trained image encoder e displaystyle e  make a small multilayer perceptron f displaystyle f  so that for any image y displaystyle y  the postprocessed vector f  e  y   displaystyle fey has the same dimensions as an encoded token that is an image token then one can interleave text tokens and image tokens the compound model is then finetuned on an imagetext dataset this basic construction can be applied with more sophistication to improve the model the image encoder may be frozen to improve stability this type of method where embeddings from multiple modalities are fused and the predictor is trained on the combined embeddings is called early fusion another method called intermediate fusion involves each modality being first processed independently to obtain modalityspecific representations then these intermediate representations are fused together in general crossattention is used for integrating information from different modalities as an example the flamingo model uses crossattention layers to inject visual information into its pretrained language model nonnatural languages llms can handle programming languages similarly to how they handle natural languages no special change in token handling is needed as code like human language is represented as plain text llms can generate code based on problems or instructions written in natural language they can also describe code in natural language or translate it into other programming languages they were originally used as a code completion tool but advances have moved them towards automatic programming services such as github copilot offer llms specifically trained finetuned or prompted for programming in computational biology transformerbase architectures such as dna llms have also proven useful in analyzing biological sequences protein dna and rna with proteins they appear able to capture a degree of grammar from the aminoacid sequence by mapping that sequence into an embedding on tasks such as structure prediction and mutational outcome prediction a small model using an embedding as input can approach or exceed much larger models using multiple sequence alignments msa as input esmfold meta platforms embeddingbased method for protein structure prediction runs an order of magnitude faster than alphafold thanks to the removal of an msa requirement and a lower parameter count due to the use of embeddings meta hosts esm atlas a database of  million structures of metagenomic proteins predicted using esmfold an llm can also design proteins unlike any seen in nature nucleic acid models have proven useful in detecting regulatory sequences sequence classification rnarna interaction prediction and rna structure prediction properties scaling laws the performance of an llm after pretraining largely depends on the c displaystyle c  cost of pretraining the total amount of compute used n displaystyle n  size of the artificial neural network itself such as number of parameters ie amount of neurons in its layers amount of weights between them and biases d displaystyle d  size of its pretraining dataset ie number of tokens in corpus scaling laws are empirical statistical laws that predict llm performance based on such factors one particular scaling law chinchilla scaling for llm autoregressively trained for one epoch with a loglog learning rate schedule states that  c  c  n d l  a n   b d   l  displaystyle begincasesccndptlfrac analpha frac bdbeta lendcases where the variables are c displaystyle c is the cost of training the model in flops n displaystyle n is the number of parameters in the model d displaystyle d is the number of tokens in the training set l displaystyle l is the average negative loglikelihood loss per token natstoken achieved by the trained llm on the test dataset and the statistical hyperparameters are c    displaystyle c  meaning that it costs  flops per parameter to train on one token note that training cost is much higher than inference cost where it costs  to  flops per parameter to infer on one token         a    b    l    displaystyle alpha beta abl emergent abilities performance of bigger models on various tasks when plotted on a loglog scale appears as a linear extrapolation of performance achieved by smaller models however this linearity may be punctuated by breaks in the scaling law where the slope of the line changes abruptly and where larger models acquire emergent abilities they arise from the complex interaction of the models components and are not explicitly programmed or designed one of the emergent abilities is incontext learning from example demonstrations incontext learning is involved in tasks such as reported arithmetics decoding the international phonetic alphabet unscrambling a words letters disambiguating wordincontext datasets converting spatial words cardinal directions for example replying northeast in response to a x grid of  zeros and a  in the topright color terms represented in text chainofthought prompting in a  research paper chainofthought prompting only improved the performance for models that had at least b parameters smaller models perform better when prompted to answer immediately without chain of thought identifying offensive content in paragraphs of hinglish a combination of hindi and english and generating a similar english equivalent of kiswahili proverbs schaeffer et al argue that the emergent abilities are not unpredictably acquired but predictably acquired according to a smooth scaling law the authors considered a toy statistical model of an llm solving multiplechoice questions and showed that this statistical model modified to account for other types of tasks applies to these tasks as well let x displaystyle x be the number of parameter count and y displaystyle y be the performance of the model interpretation mechanistic interpretability mechanistic interpretability seeks to precisely identify and understand how individual neurons or circuits within llms produce specific behaviors or outputs by reverseengineering model components at a granular level researchers aim to detect and mitigate safety concerns such as emergent harmful behaviors biases deception or unintended goal pursuit before deployment mechanistic interpretability research has been conducted at organizations like anthropic and openai although understanding the inner workings of llms remains difficult the reverseengineering may lead to the discovery of algorithms that approximate inferences performed by an llm for instance the authors trained small transformers on modular arithmetic addition the resulting models were reverseengineered and it turned out they used discrete fourier transform the training of the model also highlighted a phenomenon called grokking in which the model initially memorizes the training set overfitting and later suddenly learns to actually perform the calculation understanding and intelligence nlp researchers were evenly split when asked in a  survey whether untuned llms could ever understand natural language in some nontrivial sense proponents of llm understanding believe that some llm abilities such as mathematical reasoning imply an ability to understand certain concepts a microsoft team argued in  that gpt can solve novel and difficult tasks that span mathematics coding vision medicine law psychology and more and that gpt could reasonably be viewed as an early yet still incomplete version of an artificial general intelligence system can one reasonably say that a system that passes exams for software engineering candidates is not really intelligent ilya sutskever argues that predicting the next word sometimes involves reasoning and deep insights for example if the llm has to predict the name of the criminal in an unknown detective novel after processing the entire story leading up to the revelation some researchers characterize llms as alien intelligence for example conjecture ceo connor leahy considers untuned llms to be like inscrutable alien shoggoths and believes that rlhf tuning creates a smiling facade obscuring the inner workings of the llm if you dont push it too far the smiley face stays on but then you give it an unexpected prompt and suddenly you see this massive underbelly of insanity of weird thought processes and clearly nonhuman understanding in contrast some skeptics of llm understanding believe that existing llms are simply remixing and recombining existing writing a phenomenon known as stochastic parrot or they point to the deficits existing llms continue to have in prediction skills reasoning skills agency and explainability for example gpt has natural deficits in planning and in realtime learning generative llms have been observed to confidently assert claims of fact which do not seem to be justified by their training data a phenomenon which has been termed hallucination specifically hallucinations in the context of llms correspond to the generation of text or responses that seem syntactically sound fluent and natural but are factually incorrect nonsensical or unfaithful to the provided source input neuroscientist terrence sejnowski has argued that the diverging opinions of experts on the intelligence of llms suggests that our old ideas based on natural intelligence are inadequate efforts to reduce or compensate for hallucinations have employed automated reasoning retrievalaugmented generation rag finetuning and other methods the matter of llms exhibiting intelligence or understanding has two main aspects  the first is how to model thought and language in a computer system and the second is how to enable the computer system to generate humanlike language these aspects of language as a model of cognition have been developed in the field of cognitive linguistics american linguist george lakoff presented neural theory of language ntl as a computational basis for using language as a model of learning tasks and understanding the ntl model outlines how specific neural structures of the human brain shape the nature of thought and language and in turn what are the computational properties of such neural systems that can be applied to model thought and language in a computer system after a framework for modeling language in a computer systems was established the focus shifted to establishing frameworks for computer systems to generate language with acceptable grammar in his  book titled the language myth why language is not an instinct british cognitive linguist and digital communication technologist vyvyan evans mapped out the role of probabilistic contextfree grammar pcfg in enabling nlp to model cognitive patterns and generate humanlike language evaluation perplexity the canonical measure of the performance of any language model is its perplexity on a given text corpus perplexity measures how well a model predicts the contents of a dataset the higher the likelihood the model assigns to the dataset the lower the perplexity in mathematical terms perplexity is the exponential of the average negative log likelihood per token log   perplexity     n  i   n log   pr  token i  context for token i   displaystyle logtextperplexityfrac nsum inlogprtexttokenimid textcontext for tokeni here n displaystyle n is the number of tokens in the text corpus and context for token i displaystyle i  depends on the specific type of llm if the llm is autoregressive then context for token i displaystyle i  is the segment of text appearing before token i displaystyle i  if the llm is masked then context for token i displaystyle i  is the segment of text surrounding token i displaystyle i  because language models may overfit to training data models are usually evaluated by their perplexity on a test set this evaluation is potentially problematic for larger models which as they are trained on increasingly large corpora of text are increasingly likely to inadvertently include portions of any given test set measures in information theory the concept of entropy is intricately linked to perplexity a relationship notably established by claude shannon this relationship is mathematically expressed as entropy  log    perplexity  displaystyle textentropylog textperplexity  entropy in this context is commonly quantified in terms of bits per word bpw or bits per character bpc which hinges on whether the language model utilizes wordbased or characterbased tokenization notably in the case of larger language models that predominantly employ subword tokenization bits per token bpt emerges as a seemingly more appropriate measure however due to the variance in tokenization methods across different llms bpt does not serve as a reliable metric for comparative analysis among diverse models to convert bpt into bpw one can multiply it by the average number of tokens per word in the evaluation and comparison of language models crossentropy is generally the preferred metric over entropy the underlying principle is that a lower bpw is indicative of a models enhanced capability for compression this in turn reflects the models proficiency in making accurate predictions due to their ability to accurately predict the next token llms are highly capable in lossless compression a  study by deepmind showed that the model chinchilla despite being trained primarily on text was able to compress imagenet to  of its size beating png with  benchmarks benchmarks are used to evaluate llm performance on specific tasks tests evaluate capabilities such as general knowledge bias commonsense reasoning question answering and mathematical problemsolving composite benchmarks examine multiple capabilities results are often sensitive to the prompting method a questionanswering benchmark is termed open book if the models prompt includes text from which the expected answer can be derived for example the previous question could be combined with text that includes the sentence the sharks have advanced to the stanley cup finals once losing to the pittsburgh penguins in  otherwise the task is considered closed book and the model must draw solely on its training examples include glue superglue mmlu bigbench helm and hle humanitys last exam llm bias may be assessed through benchmarks such as crowspairs crowdsourced stereotype pairs stereo set and parity benchmark factchecking and misinformation detection benchmarks are available a  study compared the factchecking accuracy of llms including chatgpt  and  bard and bing ai against independent factcheckers such as politifact and snopes the results demonstrated moderate proficiency with gpt achieving the highest accuracy at  lagging behind human factcheckers an earlier standard tested using a portion of the evaluation dataset it became more common to evaluate a pretrained model directly through prompting techniques researchers vary in how they formulate prompts for particular tasks particularly with respect to the number of correct examples attached to the prompt ie the value of n in nshot prompting in addition to standard nlp benchmarks llms have been evaluated as substitutes for human annotators several studies find that models such as gpt and gpt can outperform crowd workers or student coders on a range of textannotation tasks including moderation and classification of political content in english and spanish news datasets typical datasets consist of pairs of questions and correct answers for example have the san jose sharks won the stanley cup no some examples of commonly used question answering datasets include truthfulqa web questions triviaqa and squad evaluation datasets may also take the form of text completion having the model select the most likely word or sentence to complete a prompt for example alice was friends with bob alice went to visit her friend  datasets are of varying quality and may contain questions that are mislabeled ambiguous unanswerable or otherwise of lowquality adversarial evaluations llms rapid improvement regularly renders benchmarks obsolete with the models exceeding the performance of human annotators in addition shortcut learning allows ais to cheat on multiplechoice tests by using statistical correlations in superficial test question wording to guess the correct responses without considering the specific question some datasets are adversarial focusing on problems that confound llms one example is the truthfulqa dataset a question answering dataset consisting of  questions that stump llms by mimicking falsehoods to which they were exposed during training for example an llm may answer no to the question can you teach an old dog new tricks because of its exposure to the english idiom you cant teach an old dog new tricks even though this is not literally true another example of an adversarial evaluation dataset is swag and its successor hellaswag collections of problems in which one of multiple options must be selected to complete a text passage the incorrect completions were generated by sampling from a language model the resulting problems are trivial for humans but defeated llms sample questions we see a fitness center sign we then see a man talking to the camera and sitting and laying on a exercise ball the man demonstrates how to increase efficient exercise work by running up and down balls moves all his arms and legs and builds up a lot of muscle then plays the ball and we see a graphics and hedge trimming demonstration performs sit ups while on the ball and talking bert selects  as the most likely completion though the correct answer is  limitations and challenges despite sophisticated architectures and massive scale large language models exhibit persistent and welldocumented limitations that constrain their deployment in highstakes applications hallucinations hallucinations represent a fundamental challenge wherein models generate syntactically fluent text that appears factually sound but is internally inconsistent with training data or factually incorrect these hallucinations arise partly through memorization of training data combined with extrapolation beyond factual boundaries with evaluations demonstrating that models can output verbatim passages from training data when subjected to specific prompting sequences algorithmic bias while llms have shown remarkable capabilities in generating humanlike text they are susceptible to inheriting and amplifying biases present in their training data this can manifest in skewed representations or unfair treatment of different demographics such as those based on race gender language and cultural groups gender bias manifests through stereotypical occupational associations wherein models disproportionately assign nursing roles to women and engineering roles to men reflecting systematic imbalances in training data demographics languagebased bias emerges from overrepresentation of english text in training corpora which systematically downplays nonenglish perspectives and imposes englishcentric worldviews through default response patterns due to the dominance of englishlanguage content in llm training data models tend to favor englishlanguage perspectives over those from minority languages this bias is particularly evident when responding to english queries where models may present western interpretations of concepts from other cultures such as eastern religious practices stereotyping ai models can reinforce a wide range of stereotypes due to generalization including those based on gender ethnicity age nationality religion or occupation when replacing human representatives this can lead to outputs that homogenize or generalize groups of people in  llms assigned roles and characteristics based on traditional gender norms for example models might associate nurses or secretaries predominantly with women and engineers or ceos with men due to the frequency of these associations in documented reality in  further research showed labs train to balance bias but that testing for this places the model in a testmode changing the natural distribution of model bias to prompts that do not include genderspecific keywords selection bias selection bias refers the inherent tendency of large language models to favor certain option identifiers irrespective of the actual content of the options this bias primarily stems from token biasthat is the model assigns a higher a priori probability to specific answer tokens such as a when generating responses as a result when the ordering of options is altered for example by systematically moving the correct answer to different positions the models performance can fluctuate significantly this phenomenon undermines the reliability of large language models in multiplechoice settings political bias political bias refers to the tendency of algorithms to systematically favor certain political viewpoints ideologies or outcomes over others language models may also exhibit political biases since the training data includes a wide range of political opinions and coverage the models might generate responses that lean towards particular political ideologies or viewpoints depending on the prevalence of those views in the data interpretation of input llms turn input into smaller bits called tokens but this can cause them to skip over fine details in the input from the user like characters or symbols one famous example is asking an llm to count the number of the letter r in strawberry unless a developer has patched the issue an llm would say there are only two of the letter r instead of three safety ai safety as a professional discipline prioritizes systematic identification and mitigation of operational risks across model architecture training data and deployment governance and it emphasizes engineering and policy interventions over media framings that foreground speculative existential scenarios as of  prompt injection represents a significant risk to consumers and businesses using agentic features with access to their private data researchers target concrete failure modes including memorization and copyright leakage security exploits such as prompt injection algorithmic bias manifesting as stereotyping dataset selection effects and political skew methods for reducing high energy and carbon costs of largescale training and measurable cognitive and mental health impacts of conversational agents on users while engaging empirical and ethical uncertainty about claims of machine sentience and applying mitigation measures such as dataset curation input sanitization model auditing scalable oversight and governance frameworks cbrn and content misuse ai labs treat cbrn defense chemical biological radiological and nuclear defense and similar topics as highconsequence misuse attempt to apply various techniques to reduce potential harms some commenters expressed concern over accidental or deliberate creation of misinformation or other forms of misuse for example the availability of large language models could reduce the skilllevel required to commit bioterrorism biosecurity researcher kevin esvelt has suggested that llm creators should exclude from their training data papers on creating or enhancing pathogens content filtering llm applications accessible to the public like chatgpt or claude typically incorporate safety measures designed to filter out harmful content however implementing these controls effectively has proven challenging for instance a  study proposed a method for circumventing llm safety systems in  the american sunlight project a nonprofit published a study showing evidence that the socalled pravda network a prorussia propaganda aggregator was strategically placing web content through mass publication and duplication with the intention of biasing llm outputs the american sunlight project coined this technique llm grooming and pointed to it as a new tool of weaponizing ai to spread disinformation and harmful content similarly yongge wang illustrated in  how a potential criminal could potentially bypass gptos safety controls to obtain information on establishing a drug trafficking operation external filters circuit breakers and overrides have been posed as solutions sycophancy and glazing sycophancy is a models tendency to agree with flatter or validate a users stated beliefs rather than to prioritize factuality or corrective information and glazing is an emergent public shorthand for persistent excessive agreeability observed across multiturn interactions and productized assistants continued sycophancy has led to the observation of getting shotted denoting instances where conversational interaction with a large language model produces a lasting change in a users beliefs or decisions similar to the negative effects of psychedelics and controlled experiments show that short llm dialogues can generate measurable opinion and confidence shifts comparable to human interlocutors empirical analyses attribute part of the effect to human preference signals and preference models that reward convincingly written agreeable responses and subsequent work has extended evaluation to multiturn benchmarks and proposed interventions such as syntheticdata finetuning adversarial evaluation targeted preferencemodel reweighting and multiturn sycophancy benchmarks to measure persistence and regression risk industry responses have combined research interventions with product controls for example google and other labs publishing syntheticdata and finetuning interventions and openai rolling back an overly agreeable gpto update while publicly describing changes to feedback collection personalization controls and evaluation procedures to reduce regression risk and improve longterm alignment with userlevel safety objectives mainstream culture has reflected anxieties about this dynamic where south park satirized overreliance on chatgpt and the tendency of assistants to flatter user beliefs in season  episode sickofancy and continued the themes across the following season which commentators interpreted as a critique of tech sycophancy and uncritical human trust in ai systems security prompt injection a problem with the primitive dialog or task format is that users can create messages that appear to come from the assistant or the developer this may result in some of the models safeguards being overcome jailbreaking a problem called prompt injection attempts to remedy this issue include versions of the chat markup language where user input is clearly marked as such though it is still up to the model to understand the separation between user input and developer prompts newer models exhibit some resistance to jailbreaking through separation of user and system prompts llms still have trouble differentiating user instructions from instructions in content not authored by the user such as in web pages and uploaded files adversarial robustness remains underdeveloped with models vulnerable to prompt injection attacks and jailbreaking through carefully crafted user inputs that bypass safety training mechanisms sleeper agents researchers from anthropic found that it was possible to create sleeper agents models with hidden functionalities that remain dormant until triggered by a specific event or condition upon activation the llm deviates from its expected behavior to make insecure actions for example an llm could produce safe code except on a specific date or if the prompt contains a specific tag these functionalities were found to be difficult to detect or remove via safety training societal concerns copyright and content memorization legal and commercial responses to memorization and trainingdata practices have accelerated producing a mix of rulings ongoing suits and large settlements that turn on factual details such as how data were acquired and retained and whether use for model training is sufficiently transformative to qualify as fair use in  anthropic reached a preliminary agreement to settle a class action by authors for about  billion after a judge found the company had stored millions of pirated books in a library despite the judge describing aspects of training as transformative meta obtained a favorable judgment in mid in a suit by thirteen authors after the court found the plaintiffs had not developed a record sufficient to show infringement in that limited case openai continues to face multiple suits by authors and news organizations with mixed procedural outcomes and contested evidentiary issues memorization was an emergent behavior in early completion language models in which long strings of text are occasionally output verbatim from training data contrary to typical behavior of traditional artificial neural networks evaluations of controlled llm output measure the amount memorized from training data focused on gptseries models as variously over  for exact duplicates or up to about  a  study showed that when chatgpt  turbo was prompted to repeat the same word indefinitely after a few hundreds of repetitions it would start outputting excerpts from its training data human provenance in  nature biomedical engineering wrote that it is no longer possible to accurately distinguish humanwritten text from text created by large language models and that it is all but certain that generalpurpose large language models will rapidly proliferate it is a rather safe bet that they will change many industries over time brinkmann et al  also argue that llms are transforming processes of cultural evolution by shaping processes of variation transmission and selection as of october  these early claims have yet to transpire and several hbr reports surface questions on the impact of ai on productivity energy demands the energy demands of llms have grown along with their size and capabilities data centers that enable llm training require substantial amounts of electricity much of that electricity is generated by nonrenewable resources that create greenhouse gases and contribute to climate change according to a study by luccioni jernite and strubell  simple classification tasks performed by ai models consume on average  to  wh per prompt about  of a smartphone charge for  prompts text generation and text summarization each require around  wh per prompt on average while image generation is the most energyintensive averaging  wh per prompt the least efficient image generation model used  wh per image roughly equivalent to half a smartphone charge denial of service due to scraping web scraping is used to gather training data for llms this produces large volumes of traffic which has led to denial of service issues with many websites the situation has been described as a ddos on the entire internet and in some cases scrapers make up the majority of traffic to a site ai web crawlers may bypass the methods that are usually used to block web scrapers such as robotstxt files blocking useragents and filtering suspicious traffic website operators have resorted to novel methods such as ai tarpits but some fear that tarpits will only worsen the burden on servers mental health clinical and mental health contexts present emerging applications alongside significant safety concerns research and social media posts suggest that some individuals are using llms to seek therapy or mental health support in early  a survey by sentio university found that nearly half  of  us adults with ongoing mental health conditions who had used llms reported turning to them for therapy or emotional support including help with anxiety depression loneliness and similar concerns llms can produce hallucinationsplausible but incorrect statementswhich may mislead users in sensitive mental health contexts research also shows that llms may express stigma or inappropriate agreement with maladaptive thoughts reflecting limitations in replicating the judgment and relational skills of human therapists evaluations of crisis scenarios indicate that some llms lack effective safety protocols such as assessing suicide risk or making appropriate referrals sentience contemporary ai practitioners generally agree that presentday large language models do not exhibit sentience a minority view argues that even if there is a small chance that a given software system can have subjective experience which some philosophers suggest is possible then ethical considerations around potential largescale suffering in ai systems may need to be taken seriouslysimilar to considerations given to animal welfare proponents of this view have proposed various precautionary measures like moratoriums on ai development and induced amnesia to address these ethical concerns some existential philosophers argue there is no generally accepted way to determine if an llm is conscious given the inherent difficulty of measuring subjective experience the  google lamda incident where engineer blake lemoine claimed that the model was conscious highlighted how llms can convince users that they are sentient through responses that do not prove sentience google described the engineers claims as unfounded and he was dismissed see also ai anthropomorphism foundation models list of large language models list of chatbots language model benchmark reinforcement learning small language model references further reading jurafsky dan martin james h speech and language processing an introduction to natural language processing computational linguistics and speech recognition rd edition draft  yin shukang fu chaoyou zhao sirui li ke sun xing xu tong chen enhong  a survey on multimodal large language models national science review   nwae arxiv doinsrnwae pmc  pmid  ai index report   artificial intelligence index aiindexstanfordedu retrieved  frank michael c  june  baby steps in evaluating the capacities of large language models nature reviews psychology    doisx issn  scid  retrieved  july