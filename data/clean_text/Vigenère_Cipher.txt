the vigenere cipher french pronunciation vin is a method of encrypting alphabetic text where each letter of the plaintext is encoded with a different caesar cipher whose increment is determined by the corresponding letter of another text the key for example if the plaintext is attacking tonight and the key is oculorhinolaryngology then the first letter of the plaintext a is shifted by  positions in the alphabet because the first letter of the key o is the th letter of the alphabet counting from zero yielding o the second letter t is shifted by  because the second letter of the key c is the nd letter of the alphabet counting from zero yielding v the third letter t is shifted by  u yielding n with wraparound and so on traditionally spaces and punctuation are removed prior to encryption and reintroduced afterwards in this example the tenth letter of the plaintext t is shifted by  positions because the tenth letter of the key o is the th letter of the alphabet counting from zero therefore the encryption yields the message ovnlqbpvt hznzeuz if the recipient of the message knows the key they can recover the plaintext by reversing this process the vigenere cipher is therefore a special case of a polyalphabetic substitution first described by giovan battista bellaso in  the cipher is easy to understand and implement but it resisted all attempts to break it until  three centuries later this earned it the description le chiffrage indechiffrable french for the indecipherable cipher many people have tried to implement encryption schemes that are essentially vigenere ciphers in  friedrich kasiski was the first to publish a general method of deciphering vigenere ciphers in the th century the scheme was misattributed to blaise de vigenere  and so acquired its present name history the very first welldocumented description of a polyalphabetic cipher was by leon battista alberti around  and used a metal cipher disk to switch between cipher alphabets albertis system only switched alphabets after several words and switches were indicated by writing the letter of the corresponding alphabet in the ciphertext later johannes trithemius in his work polygraphia which was completed in manuscript form in  but first published in  invented the tabula recta a critical component of the vigenere cipher the trithemius cipher however provided a progressive rather rigid and predictable system for switching between cipher alphabets in  blaise de vigenere published a type of polyalphabetic cipher called an autokey cipher  because its key is based on the original plaintext  before the court of henry iii of france the cipher now known as the vigenere cipher however is based on that originally described by giovan battista bellaso in his  book la cifra del sig giovan battista bellaso he built upon the tabula recta of trithemius but added a repeating countersign a key to switch cipher alphabets every letter whereas alberti and trithemius used a fixed pattern of substitutions bellasos scheme meant the pattern of substitutions could be easily changed simply by selecting a new key keys were typically single words or short phrases known to both parties in advance or transmitted out of band along with the message bellasos method thus required strong security for only the key as it is relatively easy to secure a short key phrase such as by a previous private conversation bellasos system was considerably more secure however as opposed to the modern vigenere cipher bellasos cipher did not have  different shifts different caesars ciphers for every letter instead having  shifts for pairs of letters in the th century the invention of this cipher essentially designed by bellaso was misattributed to vigenere david kahn in his book the codebreakers lamented this misattribution saying that history had ignored this important contribution and instead named a regressive and elementary cipher for him vigenere though he had nothing to do with it the vigenere cipher gained a reputation for being exceptionally strong noted author and mathematician charles lutwidge dodgson lewis carroll called the vigenere cipher unbreakable in his  piece the alphabet cipher in a childrens magazine in  scientific american described the vigenere cipher as impossible of translation that reputation was not deserved charles babbage is known to have broken a variant of the cipher as early as  but did not publish his work one hypothesis is that he intentionally kept the general method secret since he was a cryptographical adviser to his friend rearadmiral sir francis beaufort during the crimean war kasiski entirely broke the cipher and published the technique in the th century but even in the th century some skilled cryptanalysts could occasionally break the cipher the vigenere cipher is simple enough to be a field cipher if it is used in conjunction with cipher disks the confederate states of america for example used a brass cipher disk to implement the vigenere cipher during the american civil war the confederacys messages were far from secret and the union regularly cracked its messages throughout the war the confederate leadership primarily relied upon three key phrases manchester bluff complete victory and as the war came to a close come retribution a vigenere cipher with a completely random and nonreusable key which is as long as the message becomes a onetime pad a theoretically unbreakable cipher gilbert vernam tried to repair the broken cipher creating the vernamvigenere cipher in  but the technology he used was so cumbersome as to be impracticable description in a caesar cipher each letter of the alphabet is shifted along some number of places for example in a caesar cipher of shift  a would become d b would become e y would become b and so on the vigenere cipher has several caesar ciphers in sequence with different shift values to encrypt a table of alphabets can be used termed a tabula recta vigenere square or vigenere table it has the alphabet written out  times in different rows each alphabet shifted cyclically to the left compared to the previous alphabet corresponding to the  possible caesar ciphers at different points in the encryption process the cipher uses a different alphabet from one of the rows the alphabet used at each point depends on a repeating keyword for example suppose that the plaintext to be encrypted is attackatdawn the person sending the message chooses a keyword and repeats it until it matches the length of the plaintext for example the keyword lemon lemonlemonle each row starts with a key letter the rest of the row holds the letters a to z in shifted order although there are  key rows shown a code will use only as many keys different alphabets as there are unique letters in the key string here just  keys l e m o n for successive letters of the message successive letters of the key string will be taken and each message letter enciphered by using its corresponding key row when a new character of the message is selected the next letter of the key is chosen and the row corresponding to that char is gone along to find the column heading that matches the message character the letter at the intersection of keyrow msgcol is the enciphered letter for example the first letter of the plaintext a is paired with l the first letter of the key therefore row l and column a of the vigenere square are used namely l similarly for the second letter of the plaintext the second letter of the key is used the letter at row e and column t is x the rest of the plaintext is enciphered in a similar fashion decryption is performed by going to the row in the table corresponding to the key finding the position of the ciphertext letter in that row and then using the columns label as the plaintext for example in row l from lemon the ciphertext l appears in column a so a is the first plaintext letter next in row e from lemon the ciphertext x is located in column t thus t is the second plaintext letter algebraic description vigenere can also be described algebraically if the letters az are taken to be the numbers   a    displaystyle awidehat   b    displaystyle bwidehat   etc and addition is performed modulo  vigenere encryption e displaystyle e using the key k displaystyle k can be written as c i  e k  m i    m i  k i  mod   displaystyle ciekmimikibmod  and decryption d displaystyle d using the key k displaystyle k as m i  d k  c i    c i  k i  mod    displaystyle midkcicikibmod  in which m  m   m n displaystyle mmdots mn is the message c  c   c n displaystyle ccdots cn is the ciphertext and k  k   k n displaystyle kkdots kn is the key obtained by repeating the keyword  n  m  displaystyle lceil nmrceil  times in which m displaystyle m is the keyword length thus by using the previous example to encrypt a    displaystyle awidehat  with key letter l    displaystyle lwidehat  the calculation would result in    l displaystyle widehat l         mod   displaystyle bmod  therefore to decrypt r    displaystyle rwidehat  with key letter e    displaystyle ewidehat   the calculation would result in    n displaystyle widehat n         mod   displaystyle bmod  in general if  displaystyle sigma  is the alphabet of length l displaystyle ell   and m displaystyle m is the length of key vigenere encryption and decryption can be written c i  e k  m i    m i  k  i mod m   mod l  displaystyle ciekmimikibmod mbmod ell  m i  d k  c i    c i  k  i mod m   mod l  displaystyle midkcicikibmod mbmod ell  m i displaystyle mi denotes the offset of the ith character of the plaintext m displaystyle m in the alphabet  displaystyle sigma   for example by taking the  english characters as the alphabet    a  b  c    x  y  z  displaystyle sigma abcldots xyz  the offset of a is  the offset of b is  etc c i displaystyle ci and k i displaystyle ki are similar cryptanalysis the idea behind the vigenere cipher like all other polyalphabetic ciphers is to disguise the plaintext letter frequency to interfere with a straightforward application of frequency analysis for instance if p is the most frequent letter in a ciphertext whose plaintext is in english one might suspect that p corresponds to e since e is the most frequently used letter in english however by using the vigenere cipher e can be enciphered as different ciphertext letters at different points in the message which defeats simple frequency analysis the primary weakness of the vigenere cipher is the repeating nature of its key if a cryptanalyst correctly guesses the keys length n the cipher text can be treated as n interleaved caesar ciphers which can easily be broken individually the key length may be discovered by brute force testing each possible value of n or kasiski examination and the friedman test can help to determine the key length see below  kasiski examination and  friedman test kasiski examination in  friedrich kasiski was the first to publish a successful general attack on the vigenere cipher earlier attacks relied on knowledge of the plaintext or the use of a recognizable word as a key kasiskis method had no such dependencies although kasiski was the first to publish an account of the attack it is clear that others had been aware of it in  charles babbage was goaded into breaking the vigenere cipher when john hall brock thwaites submitted a new cipher to the journal of the society of the arts when babbage showed that thwaites cipher was essentially just another recreation of the vigenere cipher thwaites presented a challenge to babbage given an original text from shakespeares the tempest act  scene  and its enciphered version he was to find the key words that thwaites had used to encipher the original text babbage soon found the key words two and combined babbage then enciphered the same passage from shakespeare using different key words and challenged thwaites to find babbages key words babbage never explained the method that he used studies of babbages notes reveal that he had used the method later published by kasiski and suggest that he had been using the method as early as  the kasiski examination also called the kasiski test takes advantage of the fact that repeated words are by chance sometimes encrypted using the same key letters leading to repeated groups in the ciphertext for example consider the following encryption using the keyword abcd key abcdabcdabcdabcdabcdabcdabcd plaintext cryptoisshortforcryptography ciphertext csastpkvsiqutgqucsastpiuaqjb there is an easily noticed repetition in the ciphertext and so the kasiski test will be effective the distance between the repetitions of csastp is  if it is assumed that the repeated segments represent the same plaintext segments that implies that the key is     or  characters long all factors of the distance are possible key lengths a key of length one is just a simple caesar cipher and its cryptanalysis is much easier since key lengths  and  are unrealistically short one needs to try only lengths   and  longer messages make the test more accurate because they usually contain more repeated ciphertext segments the following ciphertext has two segments that are repeated ciphertext vhvsspqucemrvbvbbbvhvsurqgibdugrnicjqucervuaxssr the distance between the repetitions of vhvs is  if it is assumed that the repeated segments represent the same plaintext segments that implies that the key is      or  characters long the distance between the repetitions of quce is  characters that means that the key length could be        or  characters long by taking the intersection of those sets one could safely conclude that the most likely key length is  since   and  are unrealistically short friedman test the friedman test sometimes known as the kappa test was invented during the s by william f friedman who used the index of coincidence which measures the unevenness of the cipher letter frequencies to break the cipher by knowing the probability  p displaystyle kappa textp that any two randomly chosen source language letters are the same around  for caseinsensitive english and the probability of a coincidence for a uniform random selection from the alphabet  r displaystyle kappa textr    for english the key length can be estimated as the following  p   r  o   r displaystyle frac kappa textpkappa textrkappa textokappa textr from the observed coincidence rate  o   i   c n i  n i    n  n    displaystyle kappa textofrac sum icnininn in which c is the size of the alphabet  for english n is the length of the text and n to nc are the observed ciphertext letter frequencies as integers that is however only an approximation its accuracy increases with the length of the text it would in practice be necessary to try various key lengths that are close to the estimate a better approach for repeatingkey ciphers is to copy the ciphertext into rows of a matrix with as many columns as an assumed key length and then to compute the average index of coincidence with each column considered separately when that is done for each possible key length the highest average index of coincidence then corresponds to the mostlikely key length such tests may be supplemented by information from the kasiski examination frequency analysis once the length of the key is known the ciphertext can be rewritten into that many columns with each column corresponding to a single letter of the key each column consists of plaintext that has been encrypted by a single caesar cipher the caesar key shift is just the letter of the vigenere key that was used for that column using methods similar to those used to break the caesar cipher the letters in the ciphertext can be discovered an improvement to the kasiski examination known as kerckhoffs method matches each columns letter frequencies to shifted plaintext frequencies to discover the key letter caesar shift for that column once every letter in the key is known all the cryptanalyst has to do is to decrypt the ciphertext and reveal the plaintext kerckhoffs method is not applicable if the vigenere table has been scrambled rather than using normal alphabetic sequences but kasiski examination and coincidence tests can still be used to determine key length key elimination the vigenere cipher with normal alphabets essentially uses modulo arithmetic which is commutative therefore if the key length is known or guessed subtracting the cipher text from itself offset by the key length will produce the plain text subtracted from itself also offset by the key length if any probable word in the plain text is known or can be guessed its selfsubtraction can be recognized which allows recovery of the key by subtracting the known plaintext from the cipher text key elimination is especially useful against short messages for example using lion as the key below then subtract the ciphertext from itself with a shift of the key length  for lion which is nearly equivalent to subtracting the plaintext from itself by the same shift which is algebraically represented for i     n  m  displaystyle iin nm as  c i  c  i  m   mod l   e k  m i   e k  m  i  m    mod l    m i  k  i mod m   mod l   m  i  m   k   i  m  mod m   mod l  mod l    m i  k  i mod m     m  i  m   k   i  m  mod m    mod l   m i  k  i mod m   m  i  m   k   i  m  mod m   mod l   m i  m  i  m   k  i mod m   k   i  m  mod m   mod l   m i  m  i  m   k  i mod m   k  i mod m   mod l   m i  m  i  m   mod l displaystyle beginalignedcicimbmod ell ekmiekmimbmod ell mikibmod mbmod ell mimkimbmod mbmod ell bmod ell mikibmod mmimkimbmod mbmod ell mikibmod mmimkimbmod mbmod ell mimimkibmod mkimbmod mbmod ell mimimkibmod mkibmod mbmod ell mimimbmod ell endaligned in this example the words brownfox are known this result omaz corresponds with the th through th letters in the result of the larger examples above the known section and its location is verified subtract brow from that range of the ciphertext this produces the final result the reveal of the key lion variants running key the running key variant of the vigenere cipher was also considered unbreakable at one time for the key this version uses a block of text as long as the plaintext since the key is as long as the message the friedman and kasiski tests no longer work as the key is not repeated if multiple keys are used the effective key length is the least common multiple of the lengths of the individual keys for example using the two keys go and cat whose lengths are  and  one obtains an effective key length of  the least common multiple of  and  this can be understood as the point where both keys line up encrypting twice first with the key go and then with the key cat is the same as encrypting once with a key produced by encrypting one key with the other this is demonstrated by encrypting attackatdawn with iozqgh to produce the same ciphertext as in the original example if key lengths are relatively prime the effective key length is the product of the key lengths and hence grows quickly as the individual key lengths are increased for example while the effective length of combined key lengths of   and  characters is only  xxx that of key lengths of   and  characters is  xx if this effective key length is longer than the ciphertext it achieves the same immunity to the friedman and kasiski tests as the running key variant if one uses a key that is truly random is at least as long as the encrypted message and is used only once the vigenere cipher is theoretically unbreakable however in that case the key not the cipher provides cryptographic strength and such systems are properly referred to collectively as onetime pad systems irrespective of the ciphers employed variant beaufort a simple variant is to encrypt by using the vigenere decryption method and to decrypt by using vigenere encryption that method is sometimes referred to as variant beaufort it is different from the beaufort cipher created by francis beaufort which is similar to vigenere but uses a slightly modified enciphering mechanism and tableau the beaufort cipher is a reciprocal cipher gronsfeld cipher despite the vigenere ciphers apparent strength it never became widely used throughout europe the gronsfeld cipher is a variant attributed by gaspar schott to count gronsfeld josse maximilaan van gronsveld ne van bronckhorst but was actually used much earlier by an ambassador of duke of mantua in ss it is identical to the vigenere cipher except that it uses just a cipher alphabet of  characters corresponding to the digits  to  a gronsfeld key of  is the same as a vigenere key of abcd the gronsfeld cipher is strengthened because its key is not a word but it is weakened because it has just a cipher alphabet of  characters it is gronsfelds cipher that became widely used throughout germany and europe despite its weaknesses vigeneres autokey cipher vigenere actually invented a stronger cipher an autokey cipher the name vigenere cipher became associated with a simpler polyalphabetic cipher instead in fact the two ciphers were often confused and both were sometimes called le chiffre indechiffrable babbage actually broke the muchstronger autokey cipher but kasiski is generally credited with the first published solution to the fixedkey polyalphabetic ciphers see also roger frontenac nostradamus quatrain decryptor  references notes citations sources beutelspacher albrecht  chapter  cryptology translation from german by j chris fisher washington dc mathematical association of america pp  isbn  singh simon  chapter  le chiffre indechiffrable the code book anchor book random house isbn  helen f gaines  november  cryptanalysis a study of ciphers and their solution courier corporation p  isbn  mendelsohn charles j  blaise de vigenere and the chiffre carre proceedings of the american philosophical society   external links articles history of the cipher from cryptologia basic cryptanalysis at hg lecture notes on classical cryptology archived  at the wayback machine including an explanation and derivation of the friedman test videos encrypting a secret text with the vigenere cipher and the tabula recta on youtube  a video that shows and explains vigenere encryption using a simple example