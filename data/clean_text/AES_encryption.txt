the advanced encryption standard aes also known by its original name rijndael dutch pronunciation rindal is a specification for the encryption of electronic data established by the us national institute of standards and technology nist in  aes is a variant of the rijndael block cipher developed by two belgian cryptographers joan daemen and vincent rijmen who submitted a proposal to nist during the aes selection process rijndael is a family of ciphers with different key and block sizes for aes nist selected three members of the rijndael family each with a block size of  bits but three different key lengths   and  bits aes has been adopted by the us government it supersedes the data encryption standard des which was published in  the algorithm described by aes is a symmetrickey algorithm meaning the same key is used for both encrypting and decrypting the data in the united states aes was announced by the nist as us fips pub  fips  on november   this announcement followed a fiveyear standardization process in which fifteen competing designs were presented and evaluated before the rijndael cipher was selected as the most suitable aes is included in the isoiec  standard aes became effective as a us federal government standard on may   after approval by us secretary of commerce donald evans aes is available in many different encryption packages and is the first and only publicly accessible cipher approved by the us national security agency nsa for top secret information when used in an nsa approved cryptographic module see  security below definitive standards the advanced encryption standard aes is defined in each of fips pub  advanced encryption standard aes isoiec  block ciphers description of the ciphers aes is based on a design principle known as a substitutionpermutation network and is efficient in both software and hardware unlike its predecessor des aes does not use a feistel network aes is a variant of rijndael with a fixed block size of  bits and a key size of   or  bits by contrast rijndael per se is specified with block and key sizes that may be any multiple of  bits with a minimum of  and a maximum of  bits most aes calculations are done in a particular finite field aes operates on a    columnmajor order array of  bytes b b  b termed the state  b  b  b  b  b  b  b  b  b  b  b  b  b  b  b  b   displaystyle beginbmatrixbbbbbbbbbbbbbbbbendbmatrix the key size used for an aes cipher specifies the number of transformation rounds that convert the input called the plaintext into the final output called the ciphertext the number of rounds are as follows  rounds for bit keys  rounds for bit keys  rounds for bit keys each round consists of several processing steps including one that depends on the encryption key itself a set of reverse rounds are applied to transform ciphertext back into the original plaintext using the same encryption key highlevel description of the algorithm keyexpansion  round keys are derived from the cipher key using the aes key schedule aes requires a separate bit round key block for each round plus one more initial round key addition addroundkey  each byte of the state is combined with a byte of the round key using bitwise xor   or  rounds subbytes  a nonlinear substitution step where each byte is replaced with another according to a lookup table shiftrows  a transposition step where the last three rows of the state are shifted cyclically a certain number of steps mixcolumns  a linear mixing operation which operates on the columns of the state combining the four bytes in each column addroundkey final round making   or  rounds in total subbytes shiftrows addroundkey the subbytes step in the subbytes step each byte aij in the state array is replaced with a subbyte saij using an bit substitution box before round  the state array is simply the plaintextinput this operation provides the nonlinearity in the cipher the sbox used is derived from the multiplicative inverse over gf known to have good nonlinearity properties to avoid attacks based on simple algebraic properties the sbox is constructed by combining the inverse function with an invertible affine transformation the sbox is also chosen to avoid any fixed points and so is a derangement ie saij  aij and also any opposite fixed points ie saij  aij  ff while performing the decryption the invsubbytes step the inverse of subbytes is used which requires first taking the inverse of the affine transformation and then finding the multiplicative inverse the shiftrows step the shiftrows step operates on the rows of the state it cyclically shifts the bytes in each row by a certain offset for aes the first row is left unchanged each byte of the second row is shifted one to the left similarly the third and fourth rows are shifted by offsets of two and three respectively in this way each column of the output state of the shiftrows step is composed of bytes from each column of the input state the importance of this step is to avoid the columns being encrypted independently in which case aes would degenerate into four independent block ciphers the mixcolumns step in the mixcolumns step the four bytes of each column of the state are combined using an invertible linear transformation the mixcolumns function takes four bytes as input and outputs four bytes where each input byte affects all four output bytes together with shiftrows mixcolumns provides diffusion in the cipher during this operation each column is transformed using a fixed matrix matrix leftmultiplied by column gives new value of column in the state  b   j b   j b   j b   j                      a   j a   j a   j a   j    j   displaystyle beginbmatrixbjbjbjbjendbmatrixbeginbmatrixendbmatrixbeginbmatrixajajajajendbmatrixqquad leq jleq  matrix multiplication is composed of multiplication and addition of the entries entries are bytes treated as coefficients of polynomial of order x addition is simply xor multiplication is modulo irreducible polynomial x  x  x  x   if processed bit by bit then after shifting a conditional xor with b should be performed if the shifted value is larger than ff overflow must be corrected by subtraction of generating polynomial these are special cases of the usual multiplication in gf in more general sense each column is treated as a polynomial over gf and is then multiplied modulo    z     displaystyle cdot z with a fixed polynomial c  z      z      z      z    displaystyle czcdot zcdot zcdot z  the coefficients are displayed in their hexadecimal equivalent of the binary representation of bit polynomials from gfx the mixcolumns step can also be viewed as a multiplication by the shown particular mds matrix in the finite field gf this process is described further in the article rijndael mixcolumns the addroundkey in the addroundkey step the subkey is combined with the state for each round a subkey is derived from the main key using rijndaels key schedule each subkey is the same size as the state the subkey is added by combining of the state with the corresponding byte of the subkey using bitwise xor optimization of the cipher on systems with bit or larger words it is possible to speed up execution of this cipher by combining the subbytes and shiftrows steps with the mixcolumns step by transforming them into a sequence of table lookups this requires four entry bit tables together occupying  bytes a round can then be performed with  table lookup operations and  bit exclusiveor operations followed by four bit exclusiveor operations in the addroundkey step alternatively the table lookup operation can be performed with a single entry bit table occupying  bytes followed by circular rotation operations using a byteoriented approach it is possible to combine the subbytes shiftrows and mixcolumns steps into a single round operation security the national security agency nsa reviewed all the aes finalists including rijndael and stated that all of them were secure enough for us government nonclassified data in june  the us government announced that aes could be used to protect classified information the design and strength of all key lengths of the aes algorithm ie   and  are sufficient to protect classified information up to the secret level top secret information will require use of either the  or  key lengths the implementation of aes in products intended to protect national security systems andor information must be reviewed and certified by nsa prior to their acquisition and use aes has  rounds for bit keys  rounds for bit keys and  rounds for bit keys known attacks for cryptographers a cryptographic break is anything faster than a bruteforce attack  ie performing one trial decryption for each possible key in sequence see cryptanalysis  computational resources required a break can thus include results that are infeasible with current technology despite being impractical theoretical breaks can sometimes provide insight into vulnerability patterns the largest successful publicly known bruteforce attack against a widely implemented blockcipher encryption algorithm was against a bit rc key by distributednet in  the key space increases by a factor of  for each additional bit of key length and if every possible value of the key is equiprobable this translates into a doubling of the average bruteforce key search time with every additional bit of key length this implies that the effort of a bruteforce search increases exponentially with key length key length in itself does not imply security against attacks since there are ciphers with very long keys that have been found to be vulnerable aes has a fairly simple algebraic framework in  a theoretical attack named the xsl attack was announced by nicolas courtois and josef pieprzyk purporting to show a weakness in the aes algorithm partially due to the low complexity of its nonlinear components since then other papers have shown that the attack as originally presented is unworkable see xsl attack on block ciphers during the aes selection process developers of competing algorithms wrote of rijndaels algorithm we are concerned about its use  in securitycritical applications in october  however at the end of the aes selection process bruce schneier a developer of the competing algorithm twofish wrote that while he thought successful academic attacks on rijndael would be developed someday he did not believe that anyone will ever discover an attack that will allow someone to read rijndael traffic by  the best known attacks were on  rounds for bit keys  rounds for bit keys and  rounds for bit keys until may  the only successful published attacks against the full aes were sidechannel attacks on some specific implementations in  a new relatedkey attack was discovered that exploits the simplicity of aess key schedule and has a complexity of  in december  it was improved to  this is a followup to an attack discovered earlier in  by alex biryukov dmitry khovratovich and ivica nikolic with a complexity of  for one out of every  keys however relatedkey attacks are not of concern in any properly designed cryptographic protocol as a properly designed protocol ie implementational software will take care not to allow related keys essentially by constraining an attackers means of selecting keys for relatedness another attack was blogged by bruce schneier on july   and released as a preprint on august   this new attack by alex biryukov orr dunkelman nathan keller dmitry khovratovich and adi shamir is against aes that uses only two related keys and  time to recover the complete bit key of a round version or  time for a round version with a stronger type of related subkey attack or  time for an round version bit aes uses  rounds so these attacks are not effective against full aes the practicality of these attacks with stronger related keys has been criticized for instance by the paper on chosenkeyrelationsinthemiddle attacks on aes authored by vincent rijmen in  in november  the first knownkey distinguishing attack against a reduced round version of aes was released as a preprint this knownkey distinguishing attack is an improvement of the rebound or the startfromthemiddle attack against aeslike permutations which view two consecutive rounds of permutation as the application of a socalled supersbox it works on the round version of aes with a time complexity of  and a memory complexity of  bit aes uses  rounds so this attack is not effective against full aes the first keyrecovery attacks on full aes were by andrey bogdanov dmitry khovratovich and christian rechberger and were published in  the attack is a biclique attack and is faster than brute force by a factor of about four it requires  operations to recover an aes key for aes and aes  and  operations are needed respectively this result has been further improved to  for aes  for aes and  for aes by biaoshuai tao and hongjun wu in a  paper which are the current best results in key recovery attack against aes this is a very small gain as a bit key instead of  bits would still take billions of years to brute force on current and foreseeable hardware also the authors calculate the best attack using their technique on aes with a bit key requires storing  bits of data that works out to about  trillion terabytes of data which was more than all the data stored on all the computers on the planet in  a paper in  later improved the space complexity to  bits which is  terabytes while still keeping a time complexity of approximately  according to the snowden documents the nsa is doing research on whether a cryptographic attack based on tau statistic may help to break aes at present there is no known practical attack that would allow someone without knowledge of the key to read data encrypted by aes when correctly implemented sidechannel attacks sidechannel attacks do not attack the cipher as a black box and thus are not related to cipher security as defined in the classical context but are important in practice they attack implementations of the cipher on hardware or software systems that inadvertently leak data there are several such known attacks on various implementations of aes in april  d j bernstein announced a cachetiming attack that he used to break a custom server that used openssls aes encryption the attack required over  million chosen plaintexts the custom server was designed to give out as much timing information as possible the server reports back the number of machine cycles taken by the encryption operation however as bernstein pointed out reducing the precision of the servers timestamps or eliminating them from the servers responses does not stop the attack the client simply uses roundtrip timings based on its local clock and compensates for the increased noise by averaging over a larger number of samples in october  dag arne osvik adi shamir and eran tromer presented a paper demonstrating several cachetiming attacks against the implementations in aes found in openssl and linuxs dmcrypt partition encryption function one attack was able to obtain an entire aes key after only  operations triggering encryptions in a total of  milliseconds this attack requires the attacker to be able to run programs on the same system or platform that is performing aes in december  an attack on some hardware implementations was published that used differential fault analysis and allows recovery of a key with a complexity of  in november  endre bangerter david gullasch and stephan krenn published a paper which described a practical approach to a near real time recovery of secret keys from aes without the need for either cipher text or plaintext the approach also works on aes implementations that use compression tables such as openssl like some earlier attacks this one requires the ability to run unprivileged code on the system performing the aes encryption which may be achieved by malware infection far more easily than commandeering the root account in march  c ashokkumar ravi prakash giri and bernard menezes presented a sidechannel attack on aes implementations that can recover the complete bit aes key in just  blocks of plaintextciphertext which is a substantial improvement over previous works that require between  and a million encryptions the proposed attack requires standard user privilege and keyretrieval algorithms run under a minute many modern cpus have builtin hardware instructions for aes which protect against timingrelated sidechannel attacks quantum attacks aes is considered to be quantum resistant as it has similar quantum resistance to aess resistance against traditional nonquantum attacks at  bits of security aes and aes are not considered quantum resistant due to their smaller key sizes aes has a strength of  bits against quantum attacks and aes has  bits of strength against quantum attacks making them both insecure nistcsec validation the cryptographic module validation program cmvp is operated jointly by the united states governments national institute of standards and technology nist computer security division and the communications security establishment cse of the government of canada the use of cryptographic modules validated to nist fips  is required by the united states government for encryption of all data that has a classification of sensitive but unclassified sbu or above from nstissp  national policy governing the acquisition of information assurance encryption products for protecting classified information will be certified by nsa and encryption products intended for protecting sensitive information will be certified in accordance with nist fips  the government of canada also recommends the use of fips  validated cryptographic modules in unclassified applications of its departments although nist publication  fips  is the unique document that covers the aes algorithm vendors typically approach the cmvp under fips  and ask to have several algorithms such as triple des or sha validated at the same time therefore it is rare to find cryptographic modules that are uniquely fips  validated and nist itself does not generally take the time to list fips  validated modules separately on its public web site instead fips  validation is typically just listed as an fips approved aes notation with a specific fips  certificate number in the current list of fips  validated cryptographic modules the cryptographic algorithm validation program cavp allows for independent validation of the correct implementation of the aes algorithm successful validation results in being listed on the nist validations page this testing is a prerequisite for the fips  module validation however successful cavp validation in no way implies that the cryptographic module implementing the algorithm is secure a cryptographic module lacking fips  validation or specific approval by the nsa is not deemed secure by the us government and cannot be used to protect government data fips  validation is challenging to achieve both technically and fiscally there is a standardized battery of tests as well as an element of source code review that must be passed over a period of a few weeks the cost to perform these tests through an approved laboratory can be significant eg well over us and does not include the time it takes to write test document and prepare a module for validation after validation modules must be resubmitted and reevaluated if they are changed in any way this can vary from simple paperwork updates if the security functionality did not change to a more substantial set of retesting if the security functionality was impacted by the change test vectors test vectors are a set of known ciphers for a given input and key nist distributes the reference of aes test vectors as aes known answer test kat vectors performance high speed and low ram requirements were some of the criteria of the aes selection process as the chosen algorithm aes performed well on a wide variety of hardware from bit smart cards to highperformance computers on a pentium pro aes encryption requires  clock cycles per byte cpb equivalent to a throughput of about  mibs for a  mhz processor on intel core and amd ryzen cpus supporting aesni instruction set extensions throughput can be multiple gibs on an intel westmere cpu aes encryption using aesni takes about  cpb for aes and  cpb for aes implementations see also aes modes of operation disk encryption whirlpool  hash function created by vincent rijmen and paulo s l m barreto list of free and opensource software packages notes references external links bit key  bit block  aes cryptography   bit ciphers reference source code and submissions to international cryptographic designs contests embeddedsw advanced encryption standard aes pdf federal information processing standards  november  doinistfips  aes algorithm archive information  old unmaintained part  block ciphers pdf information technology  security techniques  encryption algorithms nd ed iso  isoiec e archived pdf from the original on  animation of rijndael  aes deeply explained and animated using flash by enrique zabala  university ort  montevideo  uruguay this animation in english spanish and german is also part of cryptool  menu indiv procedures  visualization of algorithms  aes html animation of rijndael  same animation as above made in html aes demo in excel  example implementation and demonstration in excel without macros by tim wambach